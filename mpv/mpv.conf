# # Общие настройки
# vo=gpu-next                # Использовать современный вывод видео через GPU (основан на libplacebo, поддерживает Vulkan)
# gpu-api=vulkan             # Предпочитать Vulkan для рендеринга (лучше для современных Intel GPU)
# hwdec=vaapi                # Аппаратное декодирование через VAAPI (предпочтительный API для Intel)
# gpu-context=auto           # Автоматически выбрать лучший контекст GPU (например, wayland, x11egl или vulkan)
# profile=high-quality       # Включить профиль высокого качества mpv по умолчанию
#
# # Вывод видео и масштабирование
# scale=ewa_lanczossharp     # Высококачественное масштабирование лумы (резкое и детализированное)
# cscale=ewa_lanczossharp    # Высококачественное масштабирование хромы
# dscale=mitchell            # Сбалансированный алгоритм понижающего масштабирования
# tscale=oversample          # Темпоральное масштабирование для плавного движения
# scale-antiring=0.6         # Уменьшить артефакты риннинга при масштабировании
# dither-depth=8             # Соответствие битовой глубины монитора для плавных градиентов
# correct-downscaling=yes    # Улучшить качество при понижающем масштабировании
# sigmoid-upscaling=yes      # Использовать сигмоидную кривую для лучшего восприятия масштабирования
# deband=yes                 # Включить подавление полос (debanning) для уменьшения артефактов полос
# deband-iterations=2        # Умеренная сила подавления полос
# deband-threshold=32        # Настроить для заметных полос
# deband-range=16            # Контроль радиуса подавления полос
# deband-grain=16            # Добавить легкое зерно для маскировки артефактов
#
# # Аппаратное декодирование
# hwdec-codecs=all           # Разрешить все кодеки для аппаратного декодирования (широкая совместимость)
# vd-lavc-dr=yes             # Включить прямой рендеринг для VAAPI для уменьшения копирования памяти
# hwdec-extra-frames=16      # Увеличить буфер для аппаратного декодирования, чтобы предотвратить пропуски кадров
#
# # Синхронизация и производительность
# video-sync=display-resample # Синхронизировать видео с частотой обновления дисплея для плавного воспроизведения
# framedrop=no               # Избегать пропуска кадров, если это не абсолютно необходимо
# vulkan-async-compute=yes    # Включить асинхронные вычисления для лучшей производительности Vulkan
# vulkan-async-transfer=yes   # Улучшить эффективность передачи Vulkan
# vulkan-queue-count=1        # Оптимизировать использование очередей Vulkan для Intel GPU
#
# # Обработка видеоформатов
# vf=format=yuv420p          # Принудительно установить YUV420p для совместимости с VAAPI и избегания многопланарных проблем
# demuxer-lavf-o=fflags=+genpts+ignidx # Использовать корректные флаги для лучшего демультиплексирования (генерация временных меток, игнорирование плохих индексов)
# video-crop=0x0+0+0         # Игнорировать обрезку, которая может вызвать сложную обработку форматов
#
# # Дополнительные шейдеры (для опытных пользователей, раскомментируйте при необходимости)
# # glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl" # Прогнозирование хромы по луме для YUV420
# # glsl-shader="~/.config/mpv/shaders/ArtCNN_C4F16.glsl"   # Оптимизированное для аниме масштабирование лумы
#
# # Интерфейс и поведение
# # border=no                  # Раскомментируйте, чтобы скрыть рамки окна для более чистого вида
# force-window=immediate     # Немедленно открывать окно
# cursor-autohide=1000       # Скрывать курсор через 1 секунду
# save-position-on-quit      # Сохранять позицию воспроизведения при выходе
# keep-open=yes              # Оставлять окно открытым после окончания воспроизведения
#
# # Сетевое стриминг (например, YouTube)
# ytdl-format=bestvideo[height<=?2160]+bestaudio/best # Ограничить до 4K, чтобы избежать чрезмерной нагрузки на GPU
# ytdl-raw-options=cookies=luakit_cookies.txt # Загружать cookies для аутентифицированного стриминга
# cache=yes                  # Включить кэширование для более плавного стриминга
# cache-secs=120             # Кэшировать 120 секунд данных
# demuxer-max-bytes=2048MiB  # Увеличить буфер демультиплексора для стриминга
#
# # Аудио
# alang=eng,en               # Предпочитать английский аудио
# volume-max=200             # Разрешить увеличение громкости, если необходимо
# ao=pulse                   # Использовать PulseAudio для Linux (используйте wasapi для Windows)
#
# # Субтитры
# slang=eng,en               # Предпочитать английские субтитры
# sub-auto=fuzzy             # Автоматически загружать внешние субтитры
# sub-font="Clear Sans"      # Чистый шрифт для субтитров
# sub-ass-force-margins=yes  # Соблюдать поля ASS-субтитров




# Общие настройки
vo=gpu-next                # Современный GPU-вывод (libplacebo, поддержка Vulkan)
gpu-api=vulkan             # Предпочитать Vulkan для лучшего рендеринга
hwdec=vaapi                # Аппаратное декодирование через VAAPI (Intel GPU)
gpu-context=auto           # Автоматически выбрать лучший контекст (wayland, x11egl, vulkan)
profile=high-quality       # Профиль высокого качества по умолчанию
background-color="#1c1c1c"

# Вывод видео и масштабирование
scale=spline36             # Высококачественное масштабирование лумы (баланс качества и производительности)
cscale=spline36            # Высококачественное масштабирование хромы
dscale=mitchell            # Сбалансированное понижающее масштабирование
tscale=oversample          # Плавное темпоральное масштабирование
scale-antiring=0.5         # Легкое уменьшение артефактов риннинга
dither-depth=8             # Соответствие битовой глубине монитора
correct-downscaling=yes    # Улучшить качество при понижающем масштабировании
sigmoid-upscaling=yes      # Сигмоидная кривая для естественного масштабирования
deband=no                  # Отключить подавление полос (снижает нагрузку, если не нужно)
# (раскомментируйте ниже, если нужны субтитры или анимации)
# deband=yes
# deband-iterations=2
# deband-threshold=32
# deband-range=16
# deband-grain=16

# Аппаратное декодирование
hwdec-codecs=all           # Поддержка всех кодеков для аппаратного декодирования
vd-lavc-dr=yes             # Прямой рендеринг для VAAPI
hwdec-extra-frames=8       # Умеренный буфер для предотвращения пропусков кадров (меньше, чем 16, для оптимизации)

# Синхронизация и производительность
video-sync=audio           # Синхронизация по аудио для стабильного A-V (лучше, чем display-resample в вашем случае)
framedrop=no               # Избегать пропуска кадров
vulkan-async-compute=yes   # Асинхронные вычисления для Vulkan
vulkan-async-transfer=yes  # Эффективная передача данных
vulkan-queue-count=1       # Оптимизация очередей для Intel GPU

# Обработка видеоформатов
# Убрать принудительный формат, чтобы MPV выбирал лучший (например, rgba16f)
# vf=format=yuv420p          # Комментируем, чтобы избежать ограничений
demuxer-lavf-o=fflags=+genpts+ignidx # Лучшее демультиплексирование
video-crop=0x0+0+0         # Нет обрезки

# Сетевое стриминг (опционально для YouTube)
cache=yes                  # Включить кэширование
cache-secs=60              # Кэшировать 60 секунд (достаточно для плавности)
demuxer-max-bytes=1024MiB  # Умеренный буфер (меньше 2048MiB для оптимизации)
ytdl-format=bestvideo[height<=?2160]+bestaudio/best
# ytdl-raw-options=cookies=luakit_cookies.txt # Для аутентификации
ytdl-raw-options=cookies-from-browser=firefox,ignore-config=,sub-langs="ru,ru-RU,^ru.*",write-sub=,write-auto-sub=
# ytdl-raw-options=cookies-from-browser=chromium:~/.local/share/qutebrowser # Для аутентификации в qutebrowser

# Аудио
alang=eng,en               # Предпочитать английский аудио
volume-max=200             # Увеличение громкости до 200%
ao=pulse                   # PulseAudio для Linux
audio-channels=2           # Стерео

# Интерфейс и поведение
force-window=immediate     # Немедленное открытие окна
cursor-autohide=1000       # Скрыть курсор через 1 секунду
save-position-on-quit      # Сохранять позицию при выходе
keep-open=yes              # Оставлять окно открытым после конца
border=yes                 # Показывать рамки окна (можно отключить: border=no)

# Субтитры (опционально)
slang=ru
sub-auto=fuzzy
sub-clear-on-seek
sub-color="#ebdbb2"

